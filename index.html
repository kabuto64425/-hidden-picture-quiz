<!doctype html>
<html class="no-js" lang=”ja”>

<head>
    <meta http-equiv="Content-Language" content="ja">
    <meta name="google" content="notranslate">
    <meta charset="utf-8">
    <title>隠し絵クイズ</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">

    <meta name="theme-color" content="#fafafa">
</head>
<body style="margin: 0;">
    <div style="height: 1800px;">
        <div style="display : flex; flex-direction: column; justify-content: center; align-items: center; margin-top:50px;">
            <div style="position: relative; height: 603px; width: 803px;">
                <div style="position: absolute; height: 600px; width: 800px; padding: 1px 2px 2px 1px;">
                    <img id="questionImage" alt="" width="100%" height="100%"></img>
                </div>
                <div style="position: absolute;">
                    <div style="display: flex">
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel1" style="height: 100%; width:100%; background-color: #ff7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel2" style="height: 100%; width:100%; background-color: #ff7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel3" style="height: 100%; width:100%; background-color: #ff7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel4" style="height: 100%; width:100%; background-color: #ff7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 3px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel5" style="height: 100%; width:100%; background-color: #ff7f7f"></div></div>
                    </div>
                    <div style="display: flex">
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel6" style="height: 100%; width:100%; background-color: #7fff7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel7" style="height: 100%; width:100%; background-color: #7fff7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel8" style="height: 100%; width:100%; background-color: #7fff7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel9" style="height: 100%; width:100%; background-color: #7fff7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 3px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel10" style="height: 100%; width:100%; background-color: #7fff7f"></div></div>
                    </div>
                    <div style="display: flex">
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel11" style="height: 100%; width:100%; background-color: #dfdfdf"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel12" style="height: 100%; width:100%; background-color: #dfdfdf"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel13" style="height: 100%; width:100%; background-color: #dfdfdf"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel14" style="height: 100%; width:100%; background-color: #dfdfdf"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 3px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel15" style="height: 100%; width:100%; background-color: #dfdfdf"></div></div>
                    </div>
                    <div style="display: flex">
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel16" style="height: 100%; width:100%; background-color: #7f7fff"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel17" style="height: 100%; width:100%; background-color: #7f7fff"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel18" style="height: 100%; width:100%; background-color: #7f7fff"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel19" style="height: 100%; width:100%; background-color: #7f7fff"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 3px 0px 3px; outline-style: solid;outline-width: 3px;"><div id="panel20" style="height: 100%; width:100%; background-color: #7f7fff"></div></div>
                    </div>
                    <div style="display: flex">
                        <div style="height: 117px; width: 157px; margin: 3px 0px 3px 3px; outline-style: solid;outline-width: 3px;"><div id="panel21" style="height: 100%; width:100%; background-color: #ffbf7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 3px 3px; outline-style: solid;outline-width: 3px;"><div id="panel22" style="height: 100%; width:100%; background-color: #ffbf7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 3px 3px; outline-style: solid;outline-width: 3px;"><div id="panel23" style="height: 100%; width:100%; background-color: #ffbf7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 3px 3px; outline-style: solid;outline-width: 3px;"><div id="panel24" style="height: 100%; width:100%; background-color: #ffbf7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 3px 3px 3px; outline-style: solid;outline-width: 3px;"><div id="panel25" style="height: 100%; width:100%; background-color: #ffbf7f"></div></div>
                    </div>
                </div>
                <div id="cover" style="position: absolute;">
                    <div style="display: flex">
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 3px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                    </div>
                    <div style="display: flex">
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 3px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                    </div>
                    <div style="display: flex">
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 3px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                    </div>
                    <div style="display: flex">
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 3px 0px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                    </div>
                    <div style="display: flex">
                        <div style="height: 117px; width: 157px; margin: 3px 0px 3px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 3px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 3px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 0px 3px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                        <div style="height: 117px; width: 157px; margin: 3px 3px 3px 3px; outline-style: solid;outline-width: 3px;"><div style="height: 100%; width:100%; background-color: #7f7f7f"></div></div>
                    </div>
                </div>
            </div>
            <div style="height: 48px;">
                <div><span id="infoUpper">↓↓出題方法はページ下にあります。</span></div>
                <div><span id="infoLower"></div>
            </div>
        </div>
    </div>
    <div>
        <div style="display : flex; justify-content: center; align-items: center;">
            <div style="width: 400px; outline-style: double; padding: 15px;">
                <h3>出題メニュー(解答者に見られないよう注意!!)</h3>
                <input id="imageFileUploader" type="file" accept=".jpg, .png, .gif"/><button id="completeButton">画像セット</button>
                <div>
                    <ul>
                        <li><span id="menuInfo">画像を選択</span></li>
                    </ul>
                </div>
            </div>
        </div>
        <h1>隠し絵クイズメーカー</h1>
        <ul>
            <li>「パネルの後ろから次第に見えてくる画像(隠し絵)は何かを当てるクイズ」が出題できます</li>
            <li>プロジェクターやリモートの画面共有を使用した出題を想定しています</li>
        </ul>
        <h1>動作確認ブラウザ</h1>
            <ul>
                <li>Google Chrome(110.0.5481.178(Official Build)(64 ビット))</li>
            </ul>
        <h1>用意するもの</h1>
        <ul>
            <li>出題する画像</li>
            <ul>
                <li>推奨する画像の大きさは幅800ピクセル×高さ600ピクセルです(4:3)</li>
                <li>それ以外画像だと自動で拡大・縮小されます。ご注意ください。</li>
            </ul>
        </ul>
        <h1>出題方法</h1>
        <ul>
            <li>画像をセット（解答者に画面を見られないように注意してください!!）</li>
            <ul>
                <li>出題メニューにある「ファイルを選択」をクリックして、出題する画像を選択します。</li>
                <li>「画像をセット」をクリックします。</li>
                <li>「画像セット完了!」と表示されるとセット完了です。</li>
            </ul>
            <li>出題（解答者に画面を見せる）</li>
            <ul>
                <li>ページのスクロールを一番上に移動し、パネルを表示します</li>
                <li>Enterキーを押すと出題が開始されます。セットした画像が次第に見えてきます。</li>
                <li>Spaceキーで一時停止します。</li>
                <ul>
                    <li>一時停止中は画像の状況を一切見ることができません。</li>
                    <li>Enterキーで再開します。</li>
                </ul>
            </ul>
            <li>再度出題する場合はページを再度読み込み、画像セットから始めてください。</li>
        </ul>
        <h1>その他</h1>
            <ul>
                <li>画像が浮かび上がるペースは約1秒ごとですが、環境により前後する可能性があります。</li>
                <li>出題に使用された画像がWeb上に送信されることはありません安心してご使用ください。</li>
                <li>このページは予告なく内容を変更あるいは廃止することもあります。ご了承願います。</li>
                <li>その他、ご不明な点がありましたら私の<a href="https://twitter.com/mussi425">Twitter</a>へ連絡をお願いします。</li>
            </ul>
    </div>
    <script>
        //framerate = 60fpsとして
        array = [...Array(25)].map((_, i) => i); //=> [ 0, 1, 2, 3, 4 ]
        let imageFileUploader;
        let completeButton;
        let questionImage;
        let cover;
        let isPause = true;
    
        let frameCount = 0;
    
        const shuffle = function(array) {
          for (let i = array.length - 1; i > 0; i--) {
            let j = Math.floor(Math.random() * (i + 1)); // 0 から i のランダムなインデックス
            [array[i], array[j]] = [array[j], array[i]]; // 要素を入れ替えます
          }
        }

        const addImageFileUploaderChangeEvent = function(e) {
            imageFileUploader.addEventListener("change", function(e) {
                menuInfo.textContent = "「画像セット」をクリック";
            });
        }

        const addCompleteButtonEvent = function() {
            completeButton.addEventListener("click", function(e) {
                imageFile = imageFileUploader.files[0];
                if(!imageFile) {
                    alert("画像を選択してください")
                    return;
                }
                // ファイルのブラウザ上でのURLを取得する
                let blobUrl = window.URL.createObjectURL(imageFile);
                questionImage.onload = function() {
                    infoUpper.textContent = "Enterでスタート!"
                    infoLower.textContent = "Spaceで一時停止"
                    menuInfo.textContent = "画像セット完了!↑↑上にスクロールして出題"
                    imageFileUploader.value = "";
                }
                questionImage.src = blobUrl;
            });
        }
    
        const addKeyOperation = function() {
            document.addEventListener("keydown", function(e){
                if(e.keyCode == 32) {
                    e.preventDefault();
                    isPause = true;
                } else if(e.keyCode == 13) {
                    e.preventDefault();
                    // すでに読み込まれているか確認
                    let image = new Image();
                    image.src = questionImage.src;
                    if(image.width === 0) {
                        alert("画像をセットしてください");
                        return;
                    }

                    infoUpper.textContent = "";
                    infoLower.textContent = "";

                    if(isPause) {
                        isPause = false;
                        // BGM再開用(BGMが不使用のため今は使わない)
                        /*if(frameCount / 60 <= 33.9) {
                            console.log(frameCount / 60)
                        }*/
                        requestAnimationFrame(main);
                    }
                }
            });
        }
    
        const main = function() {
            const begin = Date.now();
            if(isPause) {
                cover.style.visibility = "visible";
                return;
            } else {
                cover.style.visibility = "hidden";
            }
            frameCount++;
            
            if(frameCount % 60 == 0) {
                i = (frameCount / 60) - 1;
                if(i < 25) {
                    document.getElementById("panel" + (array[i] + 1)).style.setProperty("visibility", "hidden");
                }
            }
            
            // 次のrequestAnimationFrameが呼び出されるまでの実行時間を計測。デバッグ用。
            //console.log(Date.now() - begin);
            requestAnimationFrame(main);
        }
    
        window.addEventListener("load", (event) => {
            shuffle(array);
            imageFileUploader = document.getElementById("imageFileUploader");
            completeButton = document.getElementById("completeButton");
            questionImage = document.getElementById("questionImage");
            infoUpper = document.getElementById("infoUpper");
            infoLower = document.getElementById("infoLower");
            menuInfo = document.getElementById("menuInfo");
            cover = document.getElementById("cover");
            addImageFileUploaderChangeEvent();
            addCompleteButtonEvent();
            addKeyOperation();
        });
    </script>
  
    <!-- Google Analytics: change UA-XXXXX-Y to be your site"s ID. -->
    <script>
        window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
        ga("create", "UA-XXXXX-Y", "auto"); ga("set", "anonymizeIp", true); ga("set", "transport", "beacon"); ga("send", "pageview")
    </script>
    <script src="https://www.google-analytics.com/analytics.js" async></script>
</body>

</html>
